<!DOCTYPE html>
<html lang="en-GB-oxendict">
<head>
    <txp:output_form form="head" />
    <txp:if_category>
        <title>Category: <txp:category title /> / Textpattern CMS plugins</title>
        <meta name="description" content="Textpattern plugin ‘<txp:category title />’ category.">
        <meta name="robots" content="noindex, follow">
    <txp:else />
        <title>Textpattern CMS plugins | Plugins for the Textpattern content management system</title>
        <meta name="description" content="A curated collection of plugins, extensions, modifications and add-ons for Textpattern CMS.">
        <meta name="keywords" content="plugins, extensions, add-ons, modifications, cms, content management systems, open source, blogs, blogging, free, web design, web site design, web development, web site development, php, foss">
        <meta name="robots" content="index, follow">
        <link rel="canonical" href="<txp:site_url />">
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@textpattern">
        <meta name="twitter:title" content="Textpattern CMS plugins | Plugins for the Textpattern content management system">
        <meta name="twitter:description" content="A curated collection of plugins, extensions, modifications and add-ons for Textpattern CMS.">
        <meta name="twitter:image:src" content="https://textpattern.com/apple-touch-icon-180x180.png">
        <meta name="twitter:url" content="<txp:site_url />">
        <meta property="og:site_name" content="Textpattern CMS">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Textpattern CMS plugins | Plugins for the Textpattern content management system">
        <meta property="og:description" content="A curated collection of plugins, extensions, modifications and add-ons for Textpattern CMS.">
        <meta property="og:image" content="https://textpattern.com/assets/img/branding/textpattern/textpattern-og.png">
        <meta property="og:image:width" content="1200">
        <meta property="og:image:height" content="1200">
        <meta property="og:image:alt" content="Textpattern logo">
        <meta property="og:url" content="<txp:site_url />">
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "WebSite",
                "headline": "Textpattern CMS plugins | Plugins for the Textpattern content management system",
                "description": "A curated collection of plugins, extensions, modifications and add-ons for Textpattern CMS.",
                "url": "<txp:site_url escape="json" />"
            }
        </script>
    </txp:if_category>
</head>
<body itemscope itemtype="https://schema.org/WebPage">
    <txp:output_form form="body_header" />
    <main aria-label="Main content">

<txp:php>
$github_key = parse('<txp:variable name="github-api-key" />');
$github_url = explode('/', parse_url('<txp:variable name="github-repo" />', PHP_URL_PATH));

echo 'Organisation: '.$github_url[1];
echo 'Username: '.$github_url[2];

$query = <<<'JSON'
query {
  organization(login: $organizationLogin) {
    name
    url
    repository(name: $repositoryName) {
      name
    }
  }
}
JSON;
$variables = [
    'organizationLogin' => philwareham,
    'repositoryName' => hive-framework
];

$json = json_encode(['query' => $query, 'variables' => $variables]);
$curl = curl_init();

curl_setopt($curl, CURLOPT_URL, 'https://api.github.com/graphql');
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl, CURLOPT_POSTFIELDS, $json);
curl_setopt($curl, CURLOPT_HTTPHEADER,
     array(
            'User-Agent: Textpattern CMS',
            'Content-Type: application/json;charset=utf-8',
            'Authorization: bearer '.$github_key
        )
    );

$response = curl_exec($curl);

if (curl_error($curl)) {
    // Do nothing.
} else {
    echo $response;

//    foreach ($response->data->search->edges->node as $topicElement) {
//        echo '<div><h3><a href="'.$topicElement->url.'">'.htmlspecialchars($topicElement->name).'</a></h3></div>';
//    }
}

curl_close($curl);

</txp:php>


                ... TO DO ...

            </div><!-- /.container -->
        </div><!-- /.wrapper-inner -->
    </main>
    <txp:output_form form="body_footer" />
</body>
</html>
